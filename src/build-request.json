{
  "kind": "build_request",
  "title": "Fix error when opening a restaurant detail page",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the restaurant detail open flow so that clicking a restaurant card in the restaurants list reliably navigates to `/restaurants/$restaurantId` and renders the Restaurant Detail page (restaurant header + menu list) without throwing any runtime errors for all seeded restaurants.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "there is a error in opening restaurant"
        ]
      },
      "acceptanceCriteria": [
        "From the Restaurants list page, clicking any restaurant card navigates to `/restaurants/<id>` and the page renders without a blank screen or uncaught exception.",
        "The Restaurant Detail page shows a user-friendly error UI (not a crash) when the URL contains an invalid restaurantId (empty, non-numeric, or negative).",
        "If fetching restaurant or menu data fails, the existing error UI is shown (via `ErrorState`) and the Back button still works.",
        "No invalid restaurant entries (missing `id`) are clickable in the list; they are safely skipped as already intended."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Ensure backend restaurant detail APIs used by the frontend (`getRestaurant` and `getRestaurantMenu`) handle missing/invalid restaurant IDs safely (returning `null` / empty list as appropriate) and do not trap, so the frontend can always render an error or empty state instead of crashing.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "there is a error in opening restaurant"
        ]
      },
      "acceptanceCriteria": [
        "Calling `getRestaurant(<nonexistentId>)` returns `null` (or equivalent optional none) and does not trap.",
        "Calling `getRestaurantMenu(<nonexistentId>)` returns an empty list and does not trap.",
        "Existing seeded restaurant IDs (1â€“7) return their restaurant record and menu items successfully."
      ]
    }
  ],
  "constraints": [
    "Do not modify files under `frontend/src/components/ui` (read-only UI primitives).",
    "Do not modify any files listed in `frontend.immutablePaths` in SYSTEM_CONTEXT.",
    "Backend must remain a single Motoko actor in `backend/main.mo`; only add `backend/migration.mo` if state schema changes require it."
  ],
  "nonGoals": [
    "Adding new restaurant features (create/edit/delete) is out of scope.",
    "Changing authentication/Internet Identity behavior is out of scope unless required to prevent the restaurant page error."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}